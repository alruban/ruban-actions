name: "Rebased?"
run-name: "Rebased?"

on: workflow_call

jobs:
  rebase:
    runs-on: ubuntu-latest
    if: github.head_ref != 'staging' && github.head_ref != 'sgc-staging' && github.head_ref != 'sgc-production'
    steps:
      - name: ⬇️ Checkout
        uses: actions/checkout@v4
        with:
          fetch-depth: 0
      - name: Rebase check
        run: |
          hash1=$(git show-ref -s origin ${{ github.base_ref }})
          hash2=$(git merge-base origin/${{ github.base_ref }} origin/${{ github.head_ref }})
          if [ "${hash1}" = "${hash2}" ]
          then
            echo "✅ The branch is up to date"
          else
            echo "🚫 Please rebase your branch"
            exit 1
          fi
